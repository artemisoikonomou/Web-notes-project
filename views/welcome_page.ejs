<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Welcome | Now I See</title>

  <link rel="icon" type="image/png" href="/pictures/favicon.png">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Allan:wght@400;700&family=Amita:wght@400;700&family=Atma:wght@300;400;500;600;700&family=Barrio&family=Charm:wght@400;700&family=Coming+Soon&family=Delius+Swash+Caps&family=Fugaz+One&family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&family=Itim&family=Knewave&family=Lavishly+Yours&family=Lexend:wght@100..900&family=Love+Light&family=Marck+Script&family=Markazi+Text:wght@400..700&family=Montserrat+Alternates:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Montserrat:ital,wght@0,100..900;1,100..900&family=Noto+Sans+Mono:wght@100..900&family=Pacifico&family=Quintessential&family=Red+Hat+Display:ital,wght@0,300..900;1,300..900&family=Romanesco&family=Schoolbell&family=Shadows+Into+Light&family=Sriracha&family=Trade+Winds&family=Volkhov:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4Q6Gf2aSP4eDXB8Miphtr37CMZZQ5oXLH2yaXMJ2w8e2ZtHTl7GptT4jmndRuHDT" crossorigin="anonymous">
  <link rel="stylesheet" href="/style/style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" integrity="sha512-..." crossorigin="anonymous" referrerpolicy="no-referrer" />


</head>
<body>

    <!-- THIS IS THE NAVBAR -->
    <div class="navbar">
        <img class="welcome-logo" src="/pictures/logo-no-background.png" alt="logo of the app"> 
    </div>



<!-- THIS CONTAINS EVRYTHING -->
    <div class="welcome-page-container">

      <!-- THIS CONTAINS THE WELCOME MESSAGE BOX AND THE LOGIN FORM -->
        <div class="welcome-message_login-form_container">

                <!-- THIS IS THE BOX THAT CONTAINS THE WELOCOME MESSAGE -->

                <div class="welcome-message">
                    <h1>Welcome to Now I See</h1>
                    <p class="subtitle">
                    A quiet place to understand yourself, one thought at a time. <br>
                    Reflect on your experiences, give meaning to your emotions, and let your inner voice be heard. <br>
                    This is your space — to pause, to write, to grow.
                    </p>

                </div>



                <!-- THIS IS THE LOGIN FORM -->
                <div class="login-form">

                        <h1>Please login</h1> 

                        <!-- THIS IS THE ERROR MESSAGE THAT GETS A MESSAGE FROM THE BACKEND -->
                        <p id="loginError" style="color: red; min-height: 1.5em; margin-bottom: 1rem;"></p>

                        <!-- THIS IS THE FORM TO LOGIN -->
                        <form > 

                            <!-- THIS IS THE USERNAME  -->
                            <div class="form-floating"> 
                                <input type="text" class="form-control" id="signupUsername" name="username" placeholder="Your username" required>
                                <label for="signupUsername">Username</label>
                            </div> 


                            <!-- Password field with eye icon -->
                            <div class="form-floating position-relative mb-3">
                              <input type="password" class="form-control pe-5" id="floatingPassword" name="password" placeholder="Password" required />
                              <label for="floatingPassword">Password</label>
                              <!-- THIS IS THE EYE ICON THAT SHOWS AND HIDES THE PASSWORD THAT IS TYPED -->
                              <i class="fa-solid fa-eye-slash toggle-password" data-toggle="#floatingPassword" style="cursor: pointer; color: #6c757d; z-index: 2;"></i>
                            </div>


                            <!-- THIS IS THE REMEMBER ME CHECKBOX -->
                            <!-- <div class="form-check text-start my-3"> 
                                <input class="form-check-input" type="checkbox" value="remember-me" id="checkDefault"> 
                                <label class="form-check-label" for="checkDefault">Remember me</label> 
                            </div>  -->

                            <!-- THIS IS THE LOGIN BUTTON -->
                            <div class="welcome-form-login-button">
                                <button class="login-button" type="button">Login</button> 
                            </div>

                        </form>

                        <!-- THIS IS THE LINK TO CREATE A SIGN UP -->
                        <p class="signup-link new-here">* New here? <a class="signup-link"   href="/signup">Create an account</a> and begin exploring your thoughts.</p>

                </div>

        </div>

    </div>




<script>

  // THIS IS USED FOR THE EYE ICON TO WORK
    document.addEventListener('DOMContentLoaded', () => {
      // Toggle password visibility
      const toggles = document.querySelectorAll('.toggle-password');

      toggles.forEach(toggle => {
        toggle.addEventListener('click', function () {
          const targetSelector = this.getAttribute('data-toggle');
          const input = document.querySelector(targetSelector);

// It checks the current type (password or text).

// Then it switches the type:

// If it's "password" → change to "text" (show the password).

// If it's "text" → change to "password" (hide the password).
          if (input) {
            const type = input.type === 'password' ? 'text' : 'password';
            input.type = type;

            this.classList.toggle('fa-eye');
            this.classList.toggle('fa-eye-slash');
          }
        });
      });




      // THIS IS THE WHOLE CONNECTION WITH THE BACKEND (SERVER SIDE)
      const loginButton = document.querySelector('.login-button');
      const usernameInput = document.getElementById('signupUsername');
      const passwordInput = document.getElementById('floatingPassword');
      const errorElem = document.getElementById('loginError');

      loginButton.addEventListener('click', async function (e) {
        e.preventDefault();

        const username = usernameInput.value;
        const password = passwordInput.value;

        try {
          const response = await fetch('/login', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ username, password })
          });

          const data = await response.json();

          if (!response.ok) {
            errorElem.textContent = data.message || "Login failed.";
            errorElem.style.display = "block";
          } else {
            errorElem.style.display = "none";
            window.location.href = "/create_note";
          }
        } catch (err) {
          console.error(err);
          errorElem.textContent = "❌ Network error, please try again.";
          errorElem.style.display = "block";
        }
      });
    });

</script>


<%- include ("footer.ejs") %>